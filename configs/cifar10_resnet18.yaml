# configs/cifar10_resnet18.yaml (最终方案)

# --- (dataset, train, ddp 部分保持不变) ---
dataset:
  name: 'cifar10'
  data_path: './data'
  num_classes: 10
  mean: [0.4914, 0.4822, 0.4465]
  std: [0.2023, 0.1994, 0.2010]

train:
  epochs: 100
  batch_size: 1024
  optimizer: 'sgd'
  learning_rate: 0.01
  momentum: 0.9
  weight_decay: 5.0e-4
  scheduler: 'cosine'

ddp:
  dist_url: 'tcp://127.0.0.1:23456'
  dist_backend: 'nccl'
  multiprocessing_distributed: True

# ---------------------------------
# S2A 攻击配置 (最终版)
# ---------------------------------
attack:
  poison_rate: 0.1
  target_label: 0

  wavelet: 'db4'
  subband: ['hh']

  s2a:
    # --- [王牌] 结构完整性约束开关 ---
    use_structural_constraint: false
    debug: false
    # --- 触发器源 ---
    trigger_image_path: './trigger_source.png'

    # --- SSA核心参数 ---
    energy_threshold_trigger: 0.80  # 提纯触发器时保留80%能量
    energy_threshold_struc: 0.95    # 分析干净图片时保留95%能量

    # --- [最终] 注入强度控制 ---

    energy_ratio_to_structure: 0.04
    blend_ratio_in_noise: 0.8 # 80%来自触发器模式, 20%保留原始噪声

    # --- 底层SSA参数 ---
    window_size_1d: 8
    window_size_2d_h: 4
    window_size_2d_w: 4