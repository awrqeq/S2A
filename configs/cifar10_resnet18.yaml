# configs/cifar10_resnet18.yaml (最终修复版 - 包含了所有必需的训练参数)

# ---------------------------------
# 数据集配置
# ---------------------------------
dataset:
  name: 'cifar10'
  data_path: './data'
  num_classes: 10
  mean: [0.4914, 0.4822, 0.4465]
  std: [0.2023, 0.1994, 0.2010]

# ---------------------------------
# 训练配置 [!!! 已修复和补全 !!!]
# ---------------------------------
train:
  epochs: 100
  batch_size: 1024       # 这是每个GPU的 batch_size
  optimizer: 'sgd'
  # [!!! 补全 !!!] 优化器和学习率调度器所需的全部参数
  learning_rate: 0.01
  momentum: 0.9
  weight_decay: 5.0e-4
  scheduler: 'cosine'   # 使用余弦退火学习率

# ---------------------------------
# DDP (多GPU) 配置
# ---------------------------------
ddp:
  dist_url: 'tcp://127.0.0.1:23456'
  dist_backend: 'nccl'
  multiprocessing_distributed: True

# ---------------------------------
# S2A 攻击配置
# ---------------------------------
attack:
  poison_rate: 0.1
  target_label: 0

  wavelet: 'db4'
  subband: ['hl', 'lh', 'hh']

  s2a:
    use_structural_constraint: true
    trigger_image_path: './trigger_source.png'

    energy_threshold_trigger: 0.80
    energy_threshold_struc: 0.95

    base_beta: 0.3

    adaptive_strength_mid_freq:
      enabled: true
      scaling_factor: 15000.0

    adaptive_strength_high_freq:
      enabled: true
      scaling_factor: 150000.0

    window_size_1d: 8
    window_size_2d_h: 4
    window_size_2d_w: 4